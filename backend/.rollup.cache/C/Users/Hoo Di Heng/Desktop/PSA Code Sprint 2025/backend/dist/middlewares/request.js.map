{"version":3,"file":"request.js","sourceRoot":"","sources":["../../middlewares/request.ts"],"names":[],"mappings":"AACA,OAAO,QAAQ,MAAM,UAAU,CAAC;AAChC,OAAO,EAAE,SAAS,EAAE,MAAM,YAAY,CAAC;AAEvC,MAAM,CAAC,MAAM,KAAK,GACjB,CAAC,cAAwB,CAAC,IAAI,CAAC,EAAE,EAAE,CACnC,CAAC,OAAgB,EAAE,QAAkB,EAAE,IAAkB,EAAE,EAAE;IAC5D,IAAI,WAAW,CAAC,MAAM,KAAK,CAAC,EAAE,CAAC;QAC9B,IAAI,EAAE,CAAC;QACP,OAAO;IACR,CAAC;IACD,KAAK,MAAM,UAAU,IAAI,WAAW,EAAE,CAAC;QACtC,MAAM,EAAE,GAAG,OAAO,CAAC,MAAM,CAAC,UAAU,CAAC,CAAC;QACtC,IAAI,CAAC,EAAE,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,QAAQ,CAAC,OAAO,CAAC,EAAE,CAAC,EAAE,CAAC;YACjD,MAAM,GAAG,GAAG,IAAI,SAAS,CACxB,wCAAwC,EACxC,YAAY,EACZ,GAAG,CACH,CAAC;YACF,QAAQ,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;YAC/B,OAAO;QACR,CAAC;QACD,IAAI,UAAU,KAAK,IAAI,EAAE,CAAC;YACzB,QAAQ,CAAC,MAAM,CAAC,GAAG,GAAG,EAAE,CAAC;QAC1B,CAAC;aAAM,CAAC;YACP,QAAQ,CAAC,MAAM,CAAC,UAAU,CAAC,GAAG,EAAE,CAAC;QAClC,CAAC;IACF,CAAC;IACD,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,GAAG,EAAE,CAAC;QAC1B,QAAQ,CAAC,MAAM,CAAC,GAAG,GAAG,OAAO,CAAC,MAAM,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC,CAAC;IACtD,CAAC;IACD,IAAI,EAAE,CAAC;AACR,CAAC,CAAC","sourcesContent":["import { NextFunction, Request, Response } from \"express\";\r\nimport mongoose from \"mongoose\";\r\nimport { HttpError } from \"./error.js\";\r\n\r\nexport const getID =\r\n\t(queryParams: string[] = [\"ID\"]) =>\r\n\t(request: Request, response: Response, next: NextFunction) => {\r\n\t\tif (queryParams.length === 0) {\r\n\t\t\tnext();\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tfor (const queryParam of queryParams) {\r\n\t\t\tconst id = request.params[queryParam];\r\n\t\t\tif (!id || !mongoose.Types.ObjectId.isValid(id)) {\r\n\t\t\t\tconst err = new HttpError(\r\n\t\t\t\t\t\"Missing or invalid object id parameter\",\r\n\t\t\t\t\t\"INVALID_ID\",\r\n\t\t\t\t\t400\r\n\t\t\t\t);\r\n\t\t\t\tresponse.status(400).send(err);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (queryParam === \"ID\") {\r\n\t\t\t\tresponse.locals._id = id;\r\n\t\t\t} else {\r\n\t\t\t\tresponse.locals[queryParam] = id;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (!response.locals._id) {\r\n\t\t\tresponse.locals._id = request.params[queryParams[0]];\r\n\t\t}\r\n\t\tnext();\r\n\t};"]}