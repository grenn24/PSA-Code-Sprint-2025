{"version":3,"file":"error.js","sourceRoot":"","sources":["../../middlewares/error.ts"],"names":[],"mappings":"AAAA,OAAO,WAAW,MAAM,OAAO,CAAC;AAChC,OAAO,MAAM,MAAM,yBAAyB,CAAC;AAE7C,iCAAiC;AAEjC,MAAM,YAAY,GAAG,WAAW,CAAC,aAAa,CAAC,CAAC;AAEhD,MAAM,CAAC,OAAO,UAAU,KAAK,CAC5B,GAAQ,EACR,OAAY,EACZ,QAAa,EACb,IAAS;IAET,IAAI,GAAG,EAAE,CAAC;QACT,YAAY,CAAC,GAAG,CAAC,CAAC;QAClB,MAAM,CAAC,iBAAiB,CAAC,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC;QACvC,OAAO,QAAQ;aACb,MAAM,CAAC,GAAG,CAAC;aACX,IAAI,CAAC,EAAE,MAAM,EAAE,uBAAuB,EAAE,OAAO,EAAE,GAAG,CAAC,OAAO,EAAE,CAAC,CAAC;IACnE,CAAC;SAAM,CAAC;QACP,IAAI,EAAE,CAAC;IACR,CAAC;AACF,CAAC;AAED,MAAM,OAAO,SAAS;IACrB,SAAS,CAAS,CAAC,mBAAmB;IACtC,MAAM,CAAU;IAChB,OAAO,CAAS;IAChB,IAAI,CAAK;IAET,YACC,OAAe,EACf,SAA6B,SAAS,EACtC,YAAgC,GAAG,EACnC,IAAQ;QAER,IAAI,CAAC,OAAO,GAAG,OAAO,CAAC;QACvB,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC;QACrB,IAAI,CAAC,SAAS,GAAG,SAAS,CAAC;QAC3B,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC;IAClB,CAAC;CACD","sourcesContent":["import createDebug from \"debug\";\r\nimport logger from \"../utilities/winston.js\";\r\n\r\n// log uncaught errors to console\r\n\r\nconst runtimeDebug = createDebug(\"app:runtime\");\r\n\r\nexport default function error(\r\n\terr: any,\r\n\trequest: any,\r\n\tresponse: any,\r\n\tnext: any\r\n) {\r\n\tif (err) {\r\n\t\truntimeDebug(err);\r\n\t\tlogger(\"logs/errors.log\").verbose(err);\r\n\t\treturn response\r\n\t\t\t.status(500)\r\n\t\t\t.json({ status: \"INTERNAL_SERVER_ERROR\", message: err.message });\r\n\t} else {\r\n\t\tnext();\r\n\t}\r\n}\r\n\r\nexport class HttpError<T = any> {\r\n\terrorCode: number; // http status code\r\n\tstatus?: string;\r\n\tmessage: string;\r\n\tdata?: T;\r\n\r\n\tconstructor(\r\n\t\tmessage: string,\r\n\t\tstatus: string | undefined = undefined,\r\n\t\terrorCode: number | undefined = 400,\r\n\t\tdata?: T\r\n\t) {\r\n\t\tthis.message = message;\r\n\t\tthis.status = status;\r\n\t\tthis.errorCode = errorCode;\r\n\t\tthis.data = data;\r\n\t}\r\n}\r\n"]}