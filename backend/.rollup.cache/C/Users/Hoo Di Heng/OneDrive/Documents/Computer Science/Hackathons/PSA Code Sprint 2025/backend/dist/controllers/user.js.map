{"version":3,"file":"user.js","sourceRoot":"","sources":["../../controllers/user.ts"],"names":[],"mappings":"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","sourcesContent":["import { NextFunction, Request, Response } from \"express\";\r\nimport mongoose from \"mongoose\";\r\nimport { HttpError } from \"../middlewares/error.js\";\r\nimport userService from \"../services/user.js\";\r\n\r\nclass UserController {\r\n\tasync getAllUsers(request: Request, response: Response) {\r\n\t\tresponse.status(200).send(await userService.getAllUsers());\r\n\t}\r\n\r\n\tasync createUser(request: Request, response: Response) {\r\n\t\tresponse.status(201).send(await userService.createUser(request.body));\r\n\t}\r\n\r\n\tasync getUserByID(request: Request, response: Response) {\r\n\t\tconst userID = response.locals._id;\r\n\t\tresponse.status(200).send(await userService.getUserByID(userID));\r\n\t}\r\n\r\n\tasync updateUser(request: Request, response: Response) {\r\n\t\tconst userID = response.locals._id;\r\n\t\tresponse\r\n\t\t\t.status(200)\r\n\t\t\t.send(await userService.updateUser(userID, request.body));\r\n\t}\r\n\r\n\tasync addNotification(request: Request, response: Response) {\r\n\t\tconst userID = response.locals._id;\r\n\t\tresponse\r\n\t\t\t.status(200)\r\n\t\t\t.send(\r\n\t\t\t\tawait userService.addNotification(userID, request.body.message)\r\n\t\t\t);\r\n\t}\r\n\r\n\tasync sendMentorshipRequest(request: Request, response: Response) {\r\n\t\tconst userID = response.locals.user?.id;\r\n\t\tconst mentorID = response.locals._id;\r\n\t\tresponse\r\n\t\t\t.status(200)\r\n\t\t\t.send(\r\n\t\t\t\tawait userService.sendMentorshipRequest(\r\n\t\t\t\t\tuserID,\r\n\t\t\t\t\tmentorID,\r\n\t\t\t\t\trequest.body.message\r\n\t\t\t\t)\r\n\t\t\t);\r\n\t}\r\n\r\n\tasync deleteAllUsers(request: Request, response: Response) {\r\n\t\tresponse.status(200).send(await userService.deleteAllUsers());\r\n\t}\r\n\r\n\tasync getTopMatchedMentors(request: Request, response: Response) {\r\n\t\tconst userID = response.locals._id;\r\n\t\tconst limit = request.query.limit\r\n\t\t\t? Number(request.query.limit)\r\n\t\t\t: undefined;\r\n\t\t\tconst page = request.query.page\r\n\t\t\t? Number(request.query.page)\r\n\t\t\t: undefined;\r\n\t\tresponse\r\n\t\t\t.status(200)\r\n\t\t\t.send(await userService.getTopMatchedMentors(userID, limit, page));\r\n\t}\r\n\r\n\tcatchErrors(handler) {\r\n\t\treturn async (\r\n\t\t\trequest: Request,\r\n\t\t\tresponse: Response,\r\n\t\t\tnext: NextFunction\r\n\t\t) => {\r\n\t\t\ttry {\r\n\t\t\t\tawait handler(request, response);\r\n\t\t\t} catch (err) {\r\n\t\t\t\t// Custom response errors\r\n\t\t\t\tif (err instanceof HttpError) {\r\n\t\t\t\t\t// Custom response error\r\n\t\t\t\t\tresponse.status(err.errorCode).send(err);\r\n\t\t\t\t\treturn;\r\n\t\t\t\t} else if (\r\n\t\t\t\t\terr instanceof mongoose.Error.DocumentNotFoundError ||\r\n\t\t\t\t\terr instanceof mongoose.Error.ValidationError\r\n\t\t\t\t) {\r\n\t\t\t\t\tresponse.status(400).send({ message: err.message });\r\n\t\t\t\t\treturn;\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// Internal Server Errors\r\n\t\t\t\t\tnext(err);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t};\r\n\t}\r\n}\r\n\r\nconst userController = new UserController();\r\nexport default userController;\r\n"]}